var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e,t={}){return Array.isArray(e)?function(e,{addDecorativeComma:t,addDecorativeSpace:a,indentLevel:o,indentTarget:r,useUnquotedString:i}){t=t??"never",r=r??"none",o=o??0;const s=[],c=e.length>1&&("all"===r||"array"===r||"arrayInObjectAndThis"===r),d=o+(c?1:0);"arrayInObjectAndThis"===r&&(r="arrayInObject");const l="always"===a||"afterComma"===a?", ":",";let u;for(let o=0;o<e.length;o++){let p;p=void 0===u?n(e[o],{addDecorativeComma:t,addDecorativeSpace:a,indentTarget:r,indentLevel:d,useUnquotedString:i}):u,o!==e.length-1&&(u=n(e[o+1],{addDecorativeComma:t,addDecorativeSpace:a,indentTarget:r,indentLevel:d,useUnquotedString:i})),c||o===e.length-1||"always"!==t&&(p.endsWith("'")||p.endsWith("}")||p.endsWith("]")||void 0!==u&&(u.endsWith("'")||u.endsWith("}")||u.endsWith("]")))?s.push(p):s.push(p+l)}if(c){let e="\n";for(let t=0;t<o;t++)e+="    ";let t=e;return o>=0&&(t+="    "),`[${t}${s.join(t)}${e}]`}return`[${s.join("")}]`}(e,t):"object"==typeof e?function(e,{addDecorativeComma:t,addDecorativeSpace:a,indentLevel:o,indentTarget:r,useUnquotedString:i}){t=t??"never",r=r??"none",o=o??0;const s=[],c=Object.keys(e),d=c.length>1&&("all"===r||"object"===r),l=o+(d?1:0);"arrayInObject"===r&&(r="arrayInObjectAndThis");const u="always"===a||"afterComma"===a?", ":",",p="always"===a||"afterKey"===a?" ":"";for(let o=0;o<c.length;o++){const h=c[o];if(null===h.match(/^[\w-]+$/))continue;const m=e[h];if(void 0===m)continue;const f=n(m,{addDecorativeComma:t,addDecorativeSpace:a,indentTarget:r,indentLevel:l,useUnquotedString:"__"===h&&"string"==typeof m?void 0:i});f.startsWith("'")||f.startsWith("[")||f.startsWith("{")?d||o===c.length-1||"always"!==t&&"inObject"!==t?s.push(("__"===h?"":h+p)+f):s.push(("__"===h?"":h+p)+f+u):"true"===f?d||o===c.length-1?s.push(h):s.push(h+u):d||o===c.length-1?s.push(`${h} ${f}`):s.push(`${h} ${f}${u}`)}if(d){let e="\n";for(let t=0;t<o;t++)e+="    ";let t=e;return o>=0&&(t+="    "),`{${t}${s.join(t)}${e}}`}return`{${s.join("")}}`}(e,t):"number"==typeof e?e.toString():"string"==typeof e?function(e,t){if(t&&e.length>0&&e[0].trim().length>0&&(1===e.length||e[e.length-1].trim().length>0)&&!/[\n\r',\[\]{}]/.test(e)&&"true"!==e&&"false"!==e&&!/^(?:[+-]?Infinity|NaN|0x[\dA-Fa-f]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(e)&&!e.startsWith("//")&&!e.startsWith("/*"))return e;const n=["'"];for(let t=0;t<e.length;t++){const a=e[t];if("\\"!==a)"'"!==a?n.push(a):n.push("\\'");else{if(t===e.length-1){n.push("\\\\");break}const o=e[t+1];if("\\"===o||"'"===o){n.push("\\\\");continue}n.push(a)}}return n.push("'"),n.join("")}(e,t.useUnquotedString):!0===e?"true":!1===e?"false":""}function a(e){const t={},{tag:n,children:o,options:i}=e;for(const e in i){const n=i[e];t[e]="object"==typeof n?a(n):n}return"katex"===n?t.__=function(e){const t=r(e);if(1===t.length){const e=t[0];if("string"==typeof e)return e}return t}(o):("div"!==n||o.length>0)&&(t[n]=r(o)),t}function o(e){const t=[];let n="";for(const o of e)"object"!=typeof o?n+=o:(n.length>0&&(t.push(n),n=""),t.push(a(o)));return n.length>0&&t.push(n),1===t.length?t[0]:t}function r(e){const t=[];for(const n of e)t.push(o(n));return t}function i(e){return void 0===e?"":e.length<2?n(r(e),{addDecorativeComma:"inObject",addDecorativeSpace:"always",indentTarget:"arrayInObjectAndThis",useUnquotedString:!0}).slice(1,-1).trim():n(r(e),{addDecorativeComma:"inObject",addDecorativeSpace:"always",indentLevel:-1,indentTarget:"arrayInObjectAndThis",useUnquotedString:!0}).slice(1,-1).trim()}function s(e){return e.replace(/\n? *placeholder(\n|$)/g,"\n")}async function c(e,t){return await t.compileUnit({tag:"code",options:{lang:"stdn",block:!0},children:e.split("\n").map((e=>e.split("")))})}async function d(e,t){return await t.compileUnit({tag:"code",options:{lang:"ston",block:!0},children:n(t.stdn.parse(e),{addDecorativeSpace:"always",indentTarget:"all",useUnquotedString:!0}).split("\n").map((e=>e.split("")))})}async function l(e,t,n,a,o){const r=new URL("../../st-std@0.31.6","file:///home/zty/demo/dist/mod.js").href;return console.log("file:///home/zty/demo/dist/mod.js"),await o.compile([{value:e,url:a}],{style:t,headSTDN:[[{tag:"global",options:{"mod-src":r},children:[]}]],root:n})}async function u(e,t){const n=await t.compileSTDN([[{tag:"code",options:{lang:"html",block:!0},children:e.innerHTML.split("\n").map((e=>e.split("")))}]]);e.innerHTML="",e.append(n)}function p(e){if(e.currentTarget instanceof Element)for(const t of e.composedPath()){if(!(t instanceof HTMLAnchorElement))continue;const n=t.getAttribute("href");if(null===n||!n.startsWith("#"))return;if(e.stopPropagation(),e.preventDefault(),1===n.length)return void e.currentTarget.scrollIntoView();const a=decodeURIComponent(n.slice(1)),o=e.currentTarget.querySelector(`[id=${JSON.stringify(a)}]`);return void(null!==o&&o.scrollIntoView())}}e.d(t,{D5:()=>d,IT:()=>c,TA:()=>h,ji:()=>s,q6:()=>f,yK:()=>l,a$:()=>p,qz:()=>m,G2:()=>u});const h=async(e,t)=>{const n=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),r=document.createElement("textarea");a.classList.add("source"),o.classList.add("result"),n.append(a),n.append(o);let h,m=r.value=s(i(e.children));if(!0===(e.options.parse??t.context.extractLastGlobalOption("parse","demo"))){async function f(){if(void 0!==h&&r.value===m)return r.replaceWith(h),!1;if(r.disabled)return!1;r.disabled=!0,m=r.value;const e=h=await c(m,t);return a.innerHTML="",a.append(e),e.addEventListener("click",(()=>{e.replaceWith(r),r.disabled=!1,r.focus()})),o.innerHTML="",o.append(await d(m,t)),!0}return await f(),r.addEventListener("blur",(async()=>{await f()&&n.dispatchEvent(new Event("adjust",{bubbles:!0,composed:!0}))})),n}const g=o.attachShadow({mode:"open"}),v=document.createElement("style"),y=document.createElement("div");g.append(v),g.append(y);const b=!0===(e.options.html??t.context.extractLastGlobalOption("html","demo")),w=t.context.urlToAbsURL("",e);async function f(){if(void 0!==h&&r.value===m)return r.replaceWith(h),!1;if(r.disabled)return!1;r.disabled=!0,m=r.value;const e=h=await c(m,t);a.innerHTML="",a.append(e),e.addEventListener("click",(()=>{e.replaceWith(r),r.disabled=!1,r.focus()}));const n=await l(m,v,g,w,t);return void 0===n||(y.innerHTML="",y.append(n.documentFragment),!b||(await u(y,n.compiler),!0))}return await f(),r.addEventListener("blur",(async()=>{await f()&&n.dispatchEvent(new Event("adjust",{bubbles:!0,composed:!0}))})),y.addEventListener("click",p),n},m=async(e,t)=>await c(s(i(e.children)),t),f=async(e,t)=>{const n=document.createElement("div");if(!0===(e.options.parse??t.context.extractLastGlobalOption("parse","result")))return n.append(await d(i(e.children),t)),n;const a=n.attachShadow({mode:"open"}),o=document.createElement("style"),r=document.createElement("div");a.append(o),a.append(r);const s=await l(i(e.children),o,a,t.context.urlToAbsURL("",e),t);return void 0===s?n:(r.append(s.documentFragment),!0===(e.options.html??t.context.extractLastGlobalOption("html","result"))?(await u(r,s.compiler),n):(r.addEventListener("click",p),n))};var g=t.D5,v=t.IT,y=t.TA,b=t.ji,w=t.q6,T=t.yK,L=t.a$,j=t.qz,S=t.G2;export{g as createParsePre,v as createSourcePre,y as demo,b as removePlaceholders,w as result,T as shadowCompile,L as shadowHashAnchorsListener,j as source,S as toHTMLPre};