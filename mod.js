var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e,t={}){return Array.isArray(e)?function(e,{addDecorativeComma:t,addDecorativeSpace:a,indentLevel:r,indentTarget:o,useUnquotedString:i}){o=o??"none",r=r??0,t=t??"never";const c=[],s=e.length>1&&("all"===o||"array"===o||"arrayInObjectAndThis"===o),l=r+(s?1:0);"arrayInObjectAndThis"===o&&(o="arrayInObject");const d="always"===a||"afterComma"===a?", ":",";let u;for(let r=0;r<e.length;r++){let p;p=void 0===u?n(e[r],{indentTarget:o,indentLevel:l,addDecorativeComma:t,addDecorativeSpace:a,useUnquotedString:i}):u,r!==e.length-1&&(u=n(e[r+1],{indentTarget:o,indentLevel:l,addDecorativeComma:t,addDecorativeSpace:a,useUnquotedString:i})),s||r===e.length-1||"always"!==t&&(p.endsWith("'")||p.endsWith("}")||p.endsWith("]")||void 0!==u&&(u.endsWith("'")||u.endsWith("}")||u.endsWith("]")))?c.push(p):c.push(p+d)}if(s){let e="\n";for(let t=0;t<r;t++)e+="    ";let t=e;return r>=0&&(t+="    "),`[${t}${c.join(t)}${e}]`}return`[${c.join("")}]`}(e,t):"object"==typeof e?function(e,{addDecorativeComma:t,addDecorativeSpace:a,indentLevel:r,indentTarget:o,useUnquotedString:i}){o=o??"none",r=r??0,t=t??"never";const c=[],s=Object.keys(e),l=s.length>1&&("all"===o||"object"===o),d=r+(l?1:0);"arrayInObject"===o&&(o="arrayInObjectAndThis");const u="always"===a||"afterComma"===a?", ":",",p="always"===a||"afterKey"===a?" ":"";for(let r=0;r<s.length;r++){const h=s[r];if(null===h.match(/^[\w-]+$/))continue;const f=e[h];if(void 0===f)continue;const m=n(f,{indentTarget:o,indentLevel:d,addDecorativeComma:t,addDecorativeSpace:a,useUnquotedString:"__"===h&&"string"==typeof f?void 0:i});m.startsWith("'")||m.startsWith("[")||m.startsWith("{")?l||r===s.length-1||"always"!==t&&"inObject"!==t?c.push(("__"===h?"":h+p)+m):c.push(("__"===h?"":h+p)+m+u):"true"===m?l||r===s.length-1?c.push(h):c.push(h+u):l||r===s.length-1?c.push(`${h} ${m}`):c.push(`${h} ${m}${u}`)}if(l){let e="\n";for(let t=0;t<r;t++)e+="    ";let t=e;return r>=0&&(t+="    "),`{${t}${c.join(t)}${e}}'`}return`{${c.join("")}}`}(e,t):"number"==typeof e?e.toString():"string"==typeof e?function(e,t){if(t&&e.length>0&&e[0].trim().length>0&&(1===e.length||e[e.length-1].trim().length>0)&&!/[',{}\[\]\n\r]/.test(e)&&"true"!==e&&"false"!==e&&!/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(e)&&!e.startsWith("//")&&!e.startsWith("/*"))return e;const n=["'"];for(let t=0;t<e.length;t++){const a=e[t];if("\\"!==a)"'"!==a?n.push(a):n.push("\\'");else{if(t===e.length-1){n.push("\\\\");break}const r=e[t+1];if("\\"===r||"'"===r){n.push("\\\\");continue}n.push(a)}}return n.push("'"),n.join("")}(e,t.useUnquotedString):!0===e?"true":!1===e?"false":""}function a(e){const t={},{tag:n,children:a,options:r}=e;for(const e in r){let n=r[e];t[e]="object"==typeof n?{__:i(n)}:n}return"katex"===n?t.__=function(e){const t=o(e);if(1===t.length){const e=t[0];if("string"==typeof e)return e}return t}(a):("div"!==n||a.length>0)&&(t[n]=o(a)),t}function r(e){const t=[];let n="";for(const r of e)"object"!=typeof r?n+=r:(n.length>0&&(t.push(n),n=""),t.push(a(r)));return n.length>0&&t.push(n),1===t.length?t[0]:t}function o(e){const t=[];for(const n of e)t.push(r(n));return t}function i(e){const t=o(e);if(1===t.length){const e=t[0];if("object"==typeof e&&!Array.isArray(e)){const t=Object.keys(e);if(1===t.length&&"__"===t[0]){const{__:t}=e;if("string"==typeof t)return t}}}return t}function c(e){return void 0===e?"":e.length<2?n(o(e),{indentTarget:"arrayInObjectAndThis",addDecorativeComma:"inObject",addDecorativeSpace:"always",useUnquotedString:!0}).slice(1,-1).trim():n(o(e),{indentLevel:-1,indentTarget:"arrayInObjectAndThis",addDecorativeComma:"inObject",addDecorativeSpace:"always",useUnquotedString:!0}).slice(1,-1).trim()}function s(e){return e.replace(/\n? *placeholder(\n|$)/g,"\n")}async function l(e,t){return await t.compileUnit({tag:"code",options:{lang:"stdn",block:!0},children:e.split("\n").map((e=>e.split("")))})}async function d(e,t,n,a,r){return await r.compile([{value:e,url:a}],{style:t,headSTDN:[[{tag:"global",options:{"mod-gh":"st-org/st-std@0.28.3"},children:[]}]],root:n})}async function u(e,t){const n=await t.compileSTDN([[{tag:"code",options:{lang:"html",block:!0},children:e.innerHTML.split("\n").map((e=>e.split("")))}]]);e.innerHTML="",e.append(n)}function p(e){if(!(e.target instanceof HTMLAnchorElement&&e.currentTarget instanceof Element))return;const t=e.target.getAttribute("href");if(null===t||!t.startsWith("#"))return;e.stopPropagation(),e.preventDefault();const n=decodeURIComponent(t.slice(1));let a=e.currentTarget;if(n.length>0){const e=a.querySelector(`[id=${JSON.stringify(n)}]`);if(null===e)return;a=e}a.scrollIntoView()}e.d(t,{IT:()=>l,TA:()=>h,ji:()=>s,q6:()=>m,yK:()=>d,a$:()=>p,qz:()=>f,G2:()=>u});const h=async(e,t)=>{const n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),o=document.createElement("textarea"),i=r.attachShadow({mode:"open"}),h=document.createElement("style"),f=document.createElement("div");a.classList.add("source"),r.classList.add("result"),n.append(a),n.append(r),i.append(h),i.append(f);const m=!0===(e.options.html??t.extractor.extractLastGlobalOption("html","demo",t.context.tagToGlobalOptions)),g=t.context.urlToAbsURL("",e);let v,y=o.value=s(c(e.children));async function b(){if(void 0!==v&&o.value===y)return o.replaceWith(v),!1;if(o.disabled)return!1;o.disabled=!0,y=o.value;const e=await l(y,t);a.innerHTML="",v=e,a.append(e),e.addEventListener("click",(()=>{e.replaceWith(o),o.disabled=!1,o.focus()}));const n=await d(y,h,i,g,t);return void 0===n||(f.innerHTML="",f.append(n.documentFragment),!m||(await u(f,n.compiler),!0))}return await b(),f.addEventListener("click",p),o.addEventListener("blur",(async()=>{await b()&&n.dispatchEvent(new Event("adjust",{bubbles:!0,composed:!0}))})),n},f=async(e,t)=>await l(s(c(e.children)),t),m=async(e,t)=>{const n=document.createElement("div"),a=n.attachShadow({mode:"open"}),r=document.createElement("style"),o=document.createElement("div");a.append(r),a.append(o);const i=!0===(e.options.html??t.extractor.extractLastGlobalOption("html","result",t.context.tagToGlobalOptions)),s=await d(c(e.children),r,a,t.context.urlToAbsURL("",e),t);return void 0===s?n:(o.append(s.documentFragment),i?(await u(o,s.compiler),n):(o.addEventListener("click",p),n))};var g=t.IT,v=t.TA,y=t.ji,b=t.q6,T=t.yK,j=t.a$,w=t.qz,L=t.G2;export{g as createSourcePre,v as demo,y as removePlaceholders,b as result,T as shadowCompile,j as shadowHashAnchorsListener,w as source,L as toHTMLPre};